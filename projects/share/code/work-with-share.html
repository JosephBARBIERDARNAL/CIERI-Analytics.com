<!DOCTYPE html>

<html lang="en">
<head>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script async="" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" type="text/javascript">
</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-W4TQWGW3QY"></script>
<script src="/script/google-analytics.js"></script>
<meta charset="utf-8"/>
<meta content="no-cache" http-equiv="Cache-control"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<meta content="CIERI Analytics is a blog about identity, behavior and data science" name="description"/>
<meta content="analytics, data science, identity, data, science, machine learning, artificial intelligence, AI, ML, statistics, R, python, data analysis, research, behavior, psychology, social science" name="keywords"/>
<meta content="Thomas Salanova and Joseph Barbier" name="author"/>
<title>CIERI Analytics</title>
<link href="/css/main.css" rel="stylesheet"/>
</head>
<body>
<div id="header-container"></div><br/><br/>
<div class="container"><body class="jp-Notebook" data-jp-theme-light="true" data-jp-theme-name="JupyterLab Light">
<div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">

<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h1 id="Title">Title</h1><h2 id="sub-title">sub title</h2><p><a href="https://www.example.com">link</a></p>
<p><strong>bold</strong> text.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">

<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">br_dataframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_stata</span><span class="p">(</span><span class="s1">'../../../../SHARE/data/sharew6_rel8-0-0_ALL_datasets_stata/sharew6_rel8-0-0_br.dta'</span><span class="p">)</span>
<span class="n">dn_dataframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_stata</span><span class="p">(</span><span class="s1">'../../../../SHARE/data/sharew6_rel8-0-0_ALL_datasets_stata/sharew6_rel8-0-0_dn.dta'</span><span class="p">)</span>
<span class="n">ph_dataframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_stata</span><span class="p">(</span><span class="s1">'../../../../SHARE/data/sharew6_rel8-0-0_ALL_datasets_stata/sharew6_rel8-0-0_ph.dta'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">

<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">merged_dataframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">br_dataframe</span><span class="p">,</span> <span class="n">dn_dataframe</span><span class="p">,</span> <span class="n">on</span> <span class="o">=</span> <span class="s1">'mergeid'</span><span class="p">)</span>
<span class="n">merged_dataframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">merged_dataframe</span><span class="p">,</span> <span class="n">ph_dataframe</span><span class="p">,</span> <span class="n">on</span> <span class="o">=</span> <span class="s1">'mergeid'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">

<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">merged_dataframe</span><span class="p">[[</span><span class="s1">'dn014_'</span><span class="p">,</span> <span class="s1">'dn042_'</span><span class="p">,</span>
                       <span class="s1">'br002_'</span><span class="p">,</span> <span class="s1">'br015_'</span><span class="p">,</span>
                       <span class="s1">'ph003_'</span><span class="p">,</span> <span class="s1">'ph084_'</span><span class="p">,</span>
                       <span class="s1">'dn003_'</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">

<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span>
    <span class="s1">'dn014_'</span><span class="p">:</span> <span class="s1">'MaritalStatus'</span><span class="p">,</span>
    <span class="s1">'dn042_'</span><span class="p">:</span> <span class="s1">'Gender'</span><span class="p">,</span>
    <span class="s1">'dn003_'</span><span class="p">:</span> <span class="s1">'YearOfBirth'</span><span class="p">,</span>
    <span class="s1">'br002_'</span><span class="p">:</span> <span class="s1">'Smoking'</span><span class="p">,</span>
    <span class="s1">'br015_'</span><span class="p">:</span> <span class="s1">'SportFrequency'</span><span class="p">,</span>
    <span class="s1">'ph003_'</span><span class="p">:</span> <span class="s1">'HealthSelfPerception'</span><span class="p">,</span>
    <span class="s1">'ph084_'</span><span class="p">:</span> <span class="s1">'Pain'</span>
<span class="p">})</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">

<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">values_to_replace</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">"Don't know"</span><span class="p">,</span> <span class="s2">"Refusal"</span><span class="p">,</span> <span class="s2">"Implausible value/suspected wrong"</span><span class="p">,</span> 
    <span class="s2">"Not codable"</span><span class="p">,</span> <span class="s2">"Not answered"</span><span class="p">,</span> <span class="s2">"Not yet coded"</span><span class="p">,</span> <span class="s2">"Not applicable"</span>
<span class="p">]</span>
<span class="n">df</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">values_to_replace</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="s1">'NaN'</span><span class="p">),</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">

<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">column_types</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'YearOfBirth'</span><span class="p">:</span> <span class="s1">'float'</span><span class="p">,</span>
    <span class="s1">'MaritalStatus'</span><span class="p">:</span> <span class="s1">'category'</span><span class="p">,</span>
    <span class="s1">'Gender'</span><span class="p">:</span> <span class="s1">'category'</span><span class="p">,</span>
    <span class="s1">'Smoking'</span><span class="p">:</span> <span class="s1">'category'</span><span class="p">,</span>
    <span class="s1">'SportFrequency'</span><span class="p">:</span> <span class="s1">'category'</span><span class="p">,</span>
    <span class="s1">'HealthSelfPerception'</span><span class="p">:</span> <span class="s1">'category'</span><span class="p">,</span>
    <span class="s1">'Pain'</span><span class="p">:</span> <span class="s1">'category'</span>
<span class="p">}</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">column_types</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">

<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
<pre>MaritalStatus           category
Gender                  category
Smoking                 category
SportFrequency          category
HealthSelfPerception    category
Pain                    category
YearOfBirth              float64
dtype: object</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">

<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">'Age'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2021</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s1">'YearOfBirth'</span><span class="p">]</span>
<span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">'YearOfBirth'</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">categorical_columns</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">'category'</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">categorical_columns</span><span class="p">:</span>
    <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">add_categories</span><span class="p">(</span><span class="s1">'Unknown'</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">'Unknown'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">

<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">MaritalStatus</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">

<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
<pre>Unknown                                    52155
Married and living together with spouse    10555
Widowed                                     2893
Divorced                                    1127
Never married                                833
Registered partnership                       326
Married, living separated from spouse        196
Name: MaritalStatus, dtype: int64</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">

<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span> 
</pre></div>
</div>
</div>
</div>
</div>
</div>
</body></div> <!-- end of container -->
<div id="footer-container"></div>
<script src="/script/load-header-footer.js"></script>
</body>
</html>
